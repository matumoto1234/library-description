---
title: LongestCommonSubsequence
description: 動的計画法 最長共通部分列
date: 2021/04/011
---

## 説明
最長共通部分列を求めます。

長さがnの配列Aと長さがmの配列Bがあったときに
```
dp[i][j] := 配列Aのi番目,配列Bのj番目までの最長共通部分列の長さ
```
とします。

そうすると、求めたい答えは`dp[n-1][m-1]`に入っていることになります。

**流れ**  
- `dp[i-1][j-1]`
- `dp[i][j-1]`
- `dp[i-1][j]`

上記の3つが既に求まっているとき、`dp[i][j]`の値を求めることができます。

まず、$A_{i}$と$B_{j}$が等しいか等しくないかで場合分けして考えます。

<br>

 - $A_{i}$と$B_{j}$が等しい場合

($A_{i-1}$,$B_{j-1}$までの最長共通部分列の長さを+1したもの)が($A_{i}$,$B_{j}$までの最長共通部分列の長さ)になります。  
`dp[i][j] = max(dp[i][j], dp[i-1][j-1])`

<br>

 - $A_{i}$と$B_{j}$が等しくない場合

 ($A_{i-1},$B_{j}までの最長共通部分列の長さ)と($A_{i}$,$B_{j-1}$までの最長共通部分列の長さ)の大きい方になります。  
 `dp[i][j] = max({dp[i][j], dp[i-1][j], dp[i-1][j]})`


## 計算量
$$
O(NM)
$$

## 実装例


```cpp import=/assets/Library/dp/longestcommonsubsequence.cpp
```
