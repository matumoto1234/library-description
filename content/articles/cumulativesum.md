---
title: CumulativeSum
description: データ構造 累積和
date: 2021/04/07
---

## 説明
累積和をします

$query(l,r)$で左端$l$から右端$r$までの総和を求めます  
実装例では$[l,r)$でクエリを扱っています

**実装例の説明**  
累積和は元の配列$a$の$l$から$r$までの総和を前計算をすることで高速に求めることができます  

例えば,
$a = a_0 a_1 a_2 a_3$  
とあったときに,$a_2$から$a_3$の和を求めるとします

求めたいものは $a_2 + a_3$ ですが,あらかじめ前計算として値を順に足した配列$sum$を用意します

$sum_0 = a_0$  
$sum_1 = a_0 + a_1$  
$sum_2 = a_0 + a_1 + a_2$  
$sum_3 = a_0 + a_1 + a_2  + a_3$

$sum_3$から$sum_1$を引けば求めたいものが求まるのがわかると思います

$sum_i$は$i$番目までの値を$0$から足したものなので$sum_r$($r$番目まで足したもの)から$sum_l$($l$番目までを足したもの)を引くと$l+1$番目から$r$番目まで足したものが残ります

<br>

**おまけ**  
これを実装例のように半開区間にして扱いやすくするには  
$sum_i$を$i-1$番目まで足したものとして扱います

先ほどの例を使うと  
$sum_0 = 0$  
$sum_1 = a_0$  
$sum_2 = a_0 + a_1$  
$sum_3 = a_0 + a_1 + a_2$  
$sum_4 = a_0 + a_1 + a_2  + a_3$

先頭に$0$を入れることで添え字を一つずらすことができます

## 計算量
構築 $O(N)$  
クエリ $O(1)$

## 実装例

```cpp import=/assets/Library/data-structure/cumulativesum.cpp
```
